# AIOps æ™ºæ…§ç¶­é‹å ±å‘Š RAG ç³»çµ±

åŸºæ–¼ LangChain LCEL å’Œ HyDE æŠ€è¡“çš„æ™ºæ…§ç¶­é‹å ±å‘Šç”Ÿæˆç³»çµ±ï¼Œè‡ªå‹•åˆ†æç›£æ§æ•¸æ“šä¸¦ç”Ÿæˆå°ˆæ¥­çš„ç¶­é‹æ´è¦‹å ±å‘Šã€‚

## ğŸš€ æ ¸å¿ƒç‰¹è‰²

- **ğŸ¤– æ™ºæ…§åˆ†æ**: HyDE + RAG æ¶æ§‹ï¼Œç”Ÿæˆæ·±åº¦ç¶­é‹æ´è¦‹
- **ğŸ”— LangChain LCEL**: è²æ˜å¼ RAG æµç¨‹ï¼Œæ”¯æ´ fallback æ©Ÿåˆ¶
- **âš¡ é«˜æ•ˆèƒ½**: 85% API æˆæœ¬ç¯€çœï¼Œå…§å»ºæ™ºæ…§å¿«å–
- **ğŸ›¡ï¸ ä¼æ¥­ç´š**: å®Œæ•´éŒ¯èª¤è™•ç†ã€æ¸¬è©¦è¦†è“‹ç‡ 85%+
- **ğŸ“Š å³æ™‚ç›£æ§**: æ•´åˆ Prometheus + Grafana

## ğŸ“¦ å¿«é€Ÿé–‹å§‹

### 1. ä½¿ç”¨ Docker Composeï¼ˆæ¨è–¦ï¼‰

```bash
# Clone å°ˆæ¡ˆ
git clone https://github.com/your-username/aiops-rag-system.git
cd aiops-rag-system

# è¨­å®šç’°å¢ƒè®Šæ•¸
cp .env.example .env
# ç·¨è¼¯ .envï¼Œå¡«å…¥ Gemini API Key

# ä¸€éµå•Ÿå‹•
docker-compose up -d
```

### 2. æ¸¬è©¦ API

```bash
curl -X POST http://localhost:8000/api/v1/generate_report \
  -H "Content-Type: application/json" \
  -d '{
    "monitoring_data": {
      "ä¸»æ©Ÿ": "web-prod-03",
      "CPUä½¿ç”¨ç‡": "75%",
      "RAMä½¿ç”¨ç‡": "95%"
    }
  }'
```

### 3. å­˜å–æœå‹™

- **API æ–‡æª”**: http://localhost:8000/docs
- **Grafana**: http://localhost:3000 (admin/admin)
- **Prometheus**: http://localhost:9090

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI   â”‚â”€â”€â”€â”€â–¶â”‚  LangChain   â”‚â”€â”€â”€â”€â–¶â”‚   Gemini    â”‚
â”‚     API     â”‚     â”‚   RAG Chain  â”‚     â”‚  API (LLM)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                     
       â–¼                    â–¼                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Prometheus  â”‚     â”‚  OpenSearch  â”‚     â”‚   Grafana   â”‚
â”‚  Metrics    â”‚     â”‚Vector Store  â”‚     â”‚ Dashboard   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¡ ä¸»è¦åŠŸèƒ½

### 1. æ™ºæ…§å ±å‘Šç”Ÿæˆ
- HyDE æŠ€è¡“ç”Ÿæˆå‡è¨­æ€§æ–‡æª”ï¼Œæå‡æª¢ç´¢å“è³ª
- è‡ªå‹• fallback æ©Ÿåˆ¶ï¼Œç¢ºä¿æœå‹™ç©©å®šæ€§
- æ”¯æ´å¤šç¶­åº¦ç›£æ§æ•¸æ“šåˆ†æ

### 2. ä¼æ¥­ç´šéŒ¯èª¤è™•ç†
- ç´°åˆ†çš„æ¥­å‹™é‚è¼¯ä¾‹å¤–ï¼ˆVectorDBErrorã€GeminiAPIError ç­‰ï¼‰
- å…¨åŸŸéŒ¯èª¤è™•ç†å™¨ï¼Œçµ±ä¸€å›æ‡‰æ ¼å¼
- è«‹æ±‚é©—è­‰èˆ‡è©³ç´°éŒ¯èª¤è¨Šæ¯

### 3. å®Œæ•´çš„ CI/CD
- è‡ªå‹•åŒ–æ¸¬è©¦ï¼ˆè¦†è“‹ç‡ 85%+ï¼‰
- å®‰å…¨æƒæï¼ˆpip-auditã€truffleHogï¼‰
- ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥ï¼ˆblackã€pylintã€mypyï¼‰
- å®¹å™¨æ¼æ´æƒæï¼ˆTrivyï¼‰

## ğŸ“š API ç«¯é»

| ç«¯é» | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/generate_report` | POST | ç”Ÿæˆç¶­é‹å ±å‘Š |
| `/api/v1/metrics/{hostname}` | GET | å–å¾—ä¸»æ©ŸæŒ‡æ¨™ |
| `/api/v1/cache/info` | GET | å¿«å–ç‹€æ…‹è³‡è¨Š |
| `/api/v1/cache/clear` | POST | æ¸…é™¤å¿«å– |

## ğŸ› ï¸ é–‹ç™¼æŒ‡å—

### æœ¬åœ°é–‹ç™¼

```bash
# å®‰è£ä¾è³´
pip install -r requirements.txt

# åŸ·è¡Œæ¸¬è©¦
pytest tests/ --cov=src --cov-fail-under=85

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
uvicorn src.main:app --reload
```

### ä½¿ç”¨è‡ªå®šç¾©ä¾‹å¤–

```python
from src.services.exceptions import VectorDBError, GeminiAPIError

# åœ¨æœå‹™å±¤æ‹‹å‡ºç‰¹å®šä¾‹å¤–
if vector_db_connection_failed:
    raise VectorDBError("Failed to connect to OpenSearch")

# API å±¤æœƒè‡ªå‹•è™•ç†ä¸¦å›å‚³é©ç•¶çš„ HTTP ç‹€æ…‹ç¢¼
```

## ğŸ“Š æ•ˆèƒ½æŒ‡æ¨™

- **API æˆæœ¬**: é™ä½ 85%
- **å¿«å–å‘½ä¸­ç‡**: 70%+  
- **å›æ‡‰æ™‚é–“**: < 5ç§’ (P95)
- **æ¸¬è©¦è¦†è“‹ç‡**: 85%+

## ğŸ“– é€²éšæ–‡æª”

- [ç³»çµ±æ¶æ§‹è¨­è¨ˆ](./docs/architecture/system-design.md)
- [LangChain æ•´åˆæŒ‡å—](./docs/langchain_refactoring_report.md)
- [éŒ¯èª¤è™•ç†æœ€ä½³å¯¦è¸](./docs/development/error-handling.md)
- [æ•ˆèƒ½å„ªåŒ–æŒ‡å—](./docs/development/optimization-guide.md)

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ PRï¼è«‹ç¢ºä¿ï¼š
- éµå¾ªç¨‹å¼ç¢¼è¦ç¯„
- ç¶­æŒæ¸¬è©¦è¦†è“‹ç‡ 85%+
- æ›´æ–°ç›¸é—œæ–‡ä»¶

## ğŸ“ æˆæ¬Š

MIT License - è©³è¦‹ [LICENSE](LICENSE)

---

â­ è¦ºå¾—æœ‰å¹«åŠ©å—ï¼Ÿçµ¦å€‹æ˜Ÿæ˜Ÿå§ï¼
